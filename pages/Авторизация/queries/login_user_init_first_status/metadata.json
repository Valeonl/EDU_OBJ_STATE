{
  "gitSyncId": "67dd5d3c3ddf7e1ea183b23c_12e0b285-f8da-44b0-a0ec-a05e1f66a7f7",
  "id": "Авторизация_login_user_init_first_status",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "INSERT INTO appsmith.report_status_history (\n\tsession_id,\n\tcomment,\n\tcreated_date,\n\tdirectory_inn_id,\n\treport_id,\n\tstatus_id\n)\nSELECT\n    {{ this.params.session_id }}, -- ID сессии пользователя (если есть)\n    'Первичная запись статуса',   -- Комментарий\n    CURRENT_TIMESTAMP,           -- Текущая дата и время\n    {{ this.params.ou_id }},     -- Значение FK ИНН, переданное в параметры\n    r.report_id,                 -- ID отчета, полученный через JOIN\n    s.status_id                  -- ID статуса, полученный через JOIN\nFROM\n    appsmith.report r\nJOIN\n    appsmith.status s\nON\n    r.system_name = '{{ this.params.report_system_name }}' -- Системное имя отчета\n    AND s.system_name = 'in_work_ou' -- Системное имя статуса\nWHERE EXISTS (\n\tSELECT 1\n\tFROM appsmith.report_status_history rsh\n\tJOIN appsmith.status st ON rsh.status_id = st.status_id\n\tWHERE\n\trsh.directory_inn_id =  {{ this.params.ou_id }}\n\tAND rsh.created_date = (\n\t\tSELECT MAX(created_date)\n\t\tFROM appsmith.report_status_history\n\t\tWHERE directory_inn_id =  {{ this.params.ou_id }}\n\t)\n\tAND st.system_name = 'never_login'\n\tORDER BY rsh.created_date DESC\n\tLIMIT 1\n);\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": false
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "Appsmith CAD",
      "isAutoGenerated": false,
      "name": "Appsmith CAD",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "executeOnLoad": false,
    "name": "login_user_init_first_status",
    "pageId": "Авторизация",
    "userSetOnLoad": false
  }
}