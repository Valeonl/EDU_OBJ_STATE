{
  "gitSyncId": "67dd5d3c3ddf7e1ea183b23c_15b0e2db-53fe-413b-81b7-c2b2e8398078",
  "id": "Мониторинг статусов отчётов_login_user_init_first_status",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "INSERT INTO appsmith.report_status_history (\n    session_id,\n    comment,\n    created_date,\n    directory_inn_id,\n    report_id,\n    status_id\n)\nSELECT\n    {{ this.params.session_id }}, -- ID сессии пользователя (если есть)\n    'Первичная запись статуса',   -- Комментарий\n    CURRENT_TIMESTAMP,           -- Текущая дата и время\n    {{ this.params.ou_id }},     -- Значение FK ИНН, переданное в параметры\n    r.report_id,                 -- ID отчета, полученный через JOIN\n    s.status_id                  -- ID статуса, полученный через JOIN\nFROM\n    appsmith.report r\nJOIN\n    appsmith.status s\nON\n    r.system_name = '{{ this.params.report_system_name }}' -- Системное имя отчета\n    AND s.system_name = 'in_work_ou' -- Системное имя статуса\nWHERE EXISTS (\n    SELECT 1\n    FROM appsmith.report_status_history rsh\n    JOIN appsmith.status st ON rsh.status_id = st.status_id\n    WHERE\n        rsh.directory_inn_id = {{ this.params.ou_id }}\n        AND st.system_name = 'never_login'\n    ORDER BY rsh.created_date DESC\n    LIMIT 1\n);\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": false
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "Appsmith CAD Внутренний",
      "isAutoGenerated": false,
      "name": "Appsmith CAD",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "executeOnLoad": false,
    "name": "login_user_init_first_status",
    "pageId": "Мониторинг статусов отчётов",
    "userSetOnLoad": false
  }
}